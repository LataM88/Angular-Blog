<div class="comments-section mt-3">
    <h6>Komentarze ({{ comments.length }})</h6>

    @if (comments.length === 0) {
    <p class="text-muted small">Brak komentarzy. Bądź pierwszy!</p>
    }

    @for (comment of comments; track comment.id) {
    <div class="comment mb-2 p-2 bg-light rounded d-flex justify-content-between align-items-start">
        <div>
            <strong class="comment-author">{{ comment.authorName }}</strong>
            <small class="text-muted ms-2">{{ comment.createdAt | date:'short' }}</small>
            <p class="mb-0 mt-1">{{ comment.text }}</p>
        </div>
        @if (canDelete(comment)) {
        <button class="btn btn-sm btn-outline-danger" (click)="deleteComment(comment)" title="Usuń komentarz">
            <i class="fa fa-trash"></i>
        </button>
        }
    </div>
    }

    <div class="add-comment mt-3">
        @if (isLoggedIn) {
        <div class="mb-2">
            <textarea class="form-control form-control-sm" placeholder="Napisz komentarz..."
                [(ngModel)]="newCommentText" rows="2"></textarea>
        </div>
        <button class="btn btn-primary btn-sm" (click)="addComment()" [disabled]="!newCommentText">
            Dodaj komentarz
        </button>
        } @else {
        <p class="text-muted small">
            <a routerLink="/login">Zaloguj się</a> aby dodać komentarz.
        </p>
        }
    </div>
</div>